<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LUMI ‚Äî Prot√≥tipo</title>
  <meta name="description" content="Prot√≥tipo single-file da rede social LUMI para adolescentes: feed, composer, Sparkchains, Circles & Moods.">
  <style>
    :root{
      --bg: #0f1220;        /* fundo escuro elegante */
      --panel: #171a2b;
      --soft: #222641;
      --text: #e9ecff;
      --muted: #b9c0ff;
      --accent: #7c8cff;    /* acento frio e jovem */
      --accent-2: #8ef3ff;  /* detalhe ciano */
      --ok: #70ffbf;
      --warn: #ffd166;
      --danger: #ff6b6b;
      --like: #ffd1f7;
      --radius: 18px;
      --shadow: 0 10px 24px rgba(0,0,0,.35);
    }
    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; background:var(--bg); color:var(--text); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    a { color: var(--accent-2); text-decoration: none; }
    a:focus { outline: 2px dashed var(--accent-2); outline-offset: 2px; border-radius: 6px; }
    /* Layout */
    header{ position: sticky; top: 0; z-index: 10; background: linear-gradient(180deg, rgba(15,18,32,.95), rgba(15,18,32,.75)); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255,255,255,.06); }
    .wrap{ max-width: 1200px; margin: 0 auto; padding: 14px 18px; display:flex; align-items:center; gap:12px; }
    .logo{ display:flex; align-items:center; gap:10px; font-weight: 800; letter-spacing:.3px; }
    .logo-badge{ width:28px; height:28px; border-radius: 10px; background: radial-gradient(120% 120% at 20% 20%, var(--accent-2), var(--accent) 50%, #4a56b8 100%); box-shadow: 0 0 0 3px rgba(142,243,255,.15), 0 8px 30px rgba(124,140,255,.3); }
    .search{ flex:1; }
    .search input{ width:100%; padding:12px 14px; border-radius: 12px; border:1px solid rgba(255,255,255,.08); background: var(--panel); color: var(--text); }
    nav{ display:flex; gap:10px; }
    .btn{ padding:10px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.08); background: var(--panel); color:var(--text); cursor:pointer; }
    .btn:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.25); }
    .btn-ghost{ background: transparent; border-color: rgba(255,255,255,.14); }

    /* Main grid */
    .grid{ max-width: 1200px; margin: 20px auto; padding: 0 18px; display:grid; grid-template-columns: 280px minmax(0,1fr) 300px; gap: 16px; }
    @media (max-width: 980px){ .grid { grid-template-columns: 1fr; } .hide-sm{ display:none; } }

    .card{ background: var(--panel); border:1px solid rgba(255,255,255,.06); border-radius: var(--radius); box-shadow: var(--shadow); }
    .card h3{ margin:0 0 8px 0; }
    .pad { padding: 14px; }

    /* Stories */
    .stories{ display:flex; gap:10px; overflow:auto; padding: 14px; }
    .story{ flex:0 0 auto; width:80px; text-align:center; }
    .ring{ width:64px; height:64px; margin:0 auto 6px; border-radius: 50%; background: conic-gradient(var(--accent-2), var(--accent)); padding: 3px; }
    .ring > div{ width:100%; height:100%; border-radius:50%; background: var(--soft); display:grid; place-items:center; font-weight:700; }

    /* Composer */
    .composer textarea{ width:100%; min-height: 80px; resize:vertical; padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,.08); background: var(--soft); color: var(--text); }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .chip{ padding:6px 10px; border-radius: 999px; border:1px solid rgba(255,255,255,.12); background: #1c2040; color: var(--muted); font-size: 12px; cursor:pointer; }
    .chip[data-active="true"]{ background: #242a5a; color: var(--text); border-color: rgba(142,243,255,.35); }
    .select, select, input[type="file"]{ padding:10px 12px; border-radius: 10px; border:1px solid rgba(255,255,255,.1); background: var(--soft); color: var(--text);
    }
    .counter{ margin-left:auto; font-size:12px; color: var(--muted); }

    /* Feed */
    .post{ display:grid; grid-template-columns: 54px 1fr; gap:12px; padding:14px; border-top:1px solid rgba(255,255,255,.06); }
    .post:first-child{ border-top:none; }
    .avatar{ width:54px; height:54px; border-radius: 50%; background: linear-gradient(135deg, #6cf, #a8f); display:grid; place-items:center; font-weight:800; color:#0b0f1e; }
    .meta{ display:flex; align-items:center; gap:8px; font-size: 13px; color: var(--muted); }
    .name{ font-weight:700; color: var(--text); }
    .mood{ font-size:11px; padding:4px 8px; border-radius:999px; background:#1f2b3a; border:1px solid rgba(142,243,255,.25); color: var(--accent-2); }
    .aud{ font-size:11px; padding:4px 8px; border-radius:999px; background:#212652; border:1px solid rgba(255,255,255,.12); color: var(--muted); }
    .content{ line-height:1.5; white-space:pre-wrap; }
    .img{ margin-top:10px; border-radius: 14px; overflow:hidden; border:1px solid rgba(255,255,255,.08); background: #0b0f1e; height: 240px; display:grid; place-items:center; color: var(--muted); }
    .actions{ display:flex; gap:14px; align-items:center; margin-top: 10px; }
    .act{ display:inline-flex; gap:8px; align-items:center; padding:8px 12px; border-radius: 999px; border:1px solid rgba(255,255,255,.08); background: #151935; cursor:pointer; font-size: 14px; }
    .act[data-active="true"]{ border-color: rgba(255,209,247,.6); background: #1f1a2f; color: var(--like); }
    .comments{ margin-top: 8px; border-left: 2px dashed rgba(255,255,255,.06); padding-left: 12px; display:none; }
    .comment{ display:grid; grid-template-columns: 36px 1fr; gap:8px; margin:8px 0; }
    .avatar.sm{ width:36px; height:36px; font-size: 12px; }

    /* Sidebars */
    .side h4{ margin: 0 0 10px 0; color: var(--muted); font-weight:700; letter-spacing:.3px; }
    .list{ display:flex; flex-direction:column; gap:8px; }
    .item{ padding:10px; background: var(--panel); border:1px dashed rgba(255,255,255,.1); border-radius: 12px; }

    /* Footer */
    footer{ text-align:center; color: var(--muted); margin: 30px 0; font-size: 13px; }

    /* Utilities */
    .hidden{ display:none !important; }
    .toast{ position: fixed; bottom: 18px; right: 18px; background: #121632; border:1px solid rgba(255,255,255,.12); border-radius: 12px; padding: 10px 12px; box-shadow: var(--shadow); color: var(--text); opacity: 0; transform: translateY(10px); transition: all .2s ease; }
    .toast.show{ opacity: 1; transform: translateY(0); }

  </style>
</head>
<body>
  <a href="#conteudo" class="btn btn-ghost" style="position:absolute; left:-999px;">Saltar para o conte√∫do</a>
  <header role="banner" aria-label="Topo">
    <div class="wrap">
      <div class="logo" aria-label="LUMI Home">
        <div class="logo-badge" aria-hidden="true"></div>
        <span>LUMI</span>
      </div>
      <div class="search" role="search">
        <label class="hidden" for="q">Pesquisar</label>
        <input id="q" placeholder="Pesquisar pessoas, Sparks, moods‚Ä¶" />
      </div>
      <nav aria-label="Navega√ß√£o principal">
        <button class="btn btn-ghost" id="btnHome">In√≠cio</button>
        <button class="btn btn-ghost" id="btnDiscover">Descobrir</button>
        <button class="btn" id="btnCreate">Criar</button>
        <button class="btn btn-ghost" id="btnMsg">Mensagens</button>
        <button class="btn btn-ghost" id="btnProfile">Perfil</button>
      </nav>
    </div>
  </header>

  <main id="conteudo" class="grid" role="main">

    <!-- Left Sidebar -->
    <aside class="hide-sm">
      <div class="card pad">
        <h3>Circles & Moods</h3>
        <div class="list">
          <div class="item">‚ú¶ Amigos Pr√≥ximos</div>
          <div class="item">‚ú¶ Escola</div>
          <div class="item">‚ú¶ Equipa de Jogo</div>
          <div class="item">‚ú¶ Fam√≠lia</div>
        </div>
      </div>
      <div class="card pad" style="margin-top:12px;">
        <h3>Seguran√ßa</h3>
        <p style="color:var(--muted)">Controlo de privacidade por defeito em <b>Amigos</b>. Denuncie abusos nas retic√™ncias de cada post.</p>
      </div>
    </aside>

    <!-- Center Column -->
    <section>
      <div class="card stories" aria-label="Stories">
        <button class="story btn-ghost" id="addStory" aria-label="Adicionar Story">
          <div class="ring"><div>+</div></div>
          <div>Nova Story</div>
        </button>
        <div class="story">
          <div class="ring"><div>AC</div></div>
          <div>Ana</div>
        </div>
        <div class="story">
          <div class="ring"><div>JP</div></div>
          <div>Jo√£o</div>
        </div>
        <div class="story">
          <div class="ring"><div>MR</div></div>
          <div>Maria</div>
        </div>
      </div>

      <div class="card pad composer" aria-label="Criador de Conte√∫do">
        <h3>Criar Spark</h3>
        <textarea id="composerText" maxlength="280" placeholder="O que est√° a acontecer?"></textarea>
        <div class="row" style="margin-top:8px;">
          <select id="moodSel" title="Mood do post">
            <option value="üéß focado">üéß Focado</option>
            <option value="üòÑ feliz">üòÑ Feliz</option>
            <option value="üò¥ cansado">üò¥ Cansado</option>
            <option value="ü§ù colaborativo">ü§ù Colaborativo</option>
          </select>
          <select id="audSel" title="Audi√™ncia">
            <option value="Amigos">Amigos</option>
            <option value="C√≠rculos">C√≠rculos</option>
            <option value="P√∫blico">P√∫blico</option>
          </select>
          <label class="chip" for="imgInput">Imagem</label>
          <input id="imgInput" type="file" accept="image/*" class="hidden" />
          <button id="btnSpark" class="btn" aria-label="Publicar Spark">Publicar</button>
          <span class="counter" id="counter">0/280</span>
        </div>
        <div id="imgPreview" class="img hidden" aria-live="polite"></div>
        <div class="row" style="margin-top:8px;">
          <button id="btnChain" class="btn btn-ghost">Iniciar Sparkchain</button>
          <span style="font-size:12px; color:var(--muted)">Sparks colaborativas com prazo de 24h.</span>
        </div>
      </div>

      <div class="card" id="feed" aria-label="Feed">
        <!-- Posts ser√£o injetados aqui -->
      </div>
    </section>

    <!-- Right Sidebar -->
    <aside class="side hide-sm">
      <div class="card pad">
        <h4>Tend√™ncias</h4>
        <div class="list">
          <div class="item">#backtoschool</div>
          <div class="item">#fotosanalu</div>
          <div class="item">#lumiart</div>
          <div class="item">#estudo10min</div>
        </div>
      </div>
      <div class="card pad" style="margin-top:12px;">
        <h4>Guides</h4>
        <div class="list">
          <div class="item">Como criar um C√≠rculo</div>
          <div class="item">Privacidade e seguran√ßa</div>
          <div class="item">C√≥digo de conduta</div>
        </div>
      </div>
    </aside>

  </main>

  <footer>
    LUMI ‚Äî Prot√≥tipo est√°tico. Dados apenas em mem√≥ria local.
  </footer>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

<script>
  // ---------------------------------------------
  // LUMI ‚Äî prot√≥tipo est√°tico (sem backend)
  // Objetivo: demonstrar intera√ß√µes principais do produto.
  // ---------------------------------------------

  const $ = (sel, root=document) => root.querySelector(sel);
  const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

  const state = {
    posts: [],
    currentUser: { id: 'u_me', name: 'Voc√™', tag: '@voce', initials: 'VC' },
    id: 0
  };

  const toast = (msg) => {
    const el = $('#toast');
    el.textContent = msg; el.classList.add('show');
    setTimeout(() => el.classList.remove('show'), 2000);
  };

  const counter = $('#counter');
  const composerText = $('#composerText');
  const imgInput = $('#imgInput');
  const imgPreview = $('#imgPreview');
  const moodSel = $('#moodSel');
  const audSel = $('#audSel');
  const feed = $('#feed');

  composerText.addEventListener('input', () => {
    counter.textContent = `${composerText.value.length}/280`;
  });

  imgInput.addEventListener('change', (e)=>{
    const f = e.target.files?.[0];
    if(!f){ imgPreview.classList.add('hidden'); return; }
    const reader = new FileReader();
    reader.onload = () => {
      imgPreview.innerHTML = `<img src="${reader.result}" alt="Pr√©-visualiza√ß√£o" style="max-width:100%; max-height:100%; object-fit:cover;"/>`;
      imgPreview.classList.remove('hidden');
    };
    reader.readAsDataURL(f);
  });

  $('#btnSpark').addEventListener('click', () => {
    const text = composerText.value.trim();
    if(!text && imgPreview.classList.contains('hidden')){
      toast('Escreva algo ou adicione uma imagem.');
      return;
    }
    const post = createPost({
      author: state.currentUser,
      text,
      mood: moodSel.value,
      audience: audSel.value,
      img: imgPreview.classList.contains('hidden') ? null : $('img', imgPreview)?.src,
      chain: null
    });
    prependPost(post);
    composerText.value = ''; counter.textContent = '0/280';
    imgPreview.classList.add('hidden'); imgPreview.innerHTML='';
    toast('Spark publicado!');
  });

  $('#btnChain').addEventListener('click', () => {
    const prompt = promptChain();
    if(!prompt) return;
    const post = createPost({
      author: state.currentUser,
      text: prompt + "\n\nParticipe adicionando o seu passo ‚ú®",
      mood: 'ü§ù colaborativo',
      audience: 'P√∫blico',
      img: null,
      chain: { deadline: Date.now() + 24*60*60*1000, nodes: [] }
    });
    prependPost(post);
    toast('Sparkchain iniciada. Expira em 24h.');
  });

  function promptChain(){
    return window.prompt('Tema da Sparkchain (ex.: "Cria uma letra, cada um escreve 1 verso")');
  }

  function createPost({author, text, mood, audience, img, chain}){
    const id = `p_${++state.id}`;
    const now = new Date();
    const post = { id, author, text, mood, audience, img, chain, createdAt: now, likes: 0, liked:false, comments: [] };
    state.posts.unshift(post);
    return post;
  }

  function prependPost(post){
    const el = renderPost(post);
    feed.prepend(el);
  }

  function renderPost(post){
    const el = document.createElement('article');
    el.className = 'post';
    el.setAttribute('aria-label', 'Post');
    el.innerHTML = `
      <div class="avatar" aria-hidden="true">${post.author.initials}</div>
      <div>
        <div class="meta">
          <span class="name">${escapeHtml(post.author.name)}</span>
          <span>@${escapeHtml(post.author.tag?.replace('@','') || 'user')}</span>
          <span>¬∑ ${timeAgo(post.createdAt)}</span>
          <span class="mood" title="Mood">${escapeHtml(post.mood)}</span>
          <span class="aud" title="Audi√™ncia">${escapeHtml(post.audience)}</span>
        </div>
        <div class="content">${linkify(escapeHtml(post.text))}</div>
        ${post.img ? `<div class="img"><img src="${post.img}" alt="Imagem do post" style="max-width:100%; max-height:100%; object-fit:cover;"/></div>`: ''}
        ${post.chain ? chainBadge(post.chain) : ''}
        <div class="actions">
          <button class="act act-like" aria-pressed="${post.liked}" data-id="${post.id}">‚ö° <span>${post.likes}</span></button>
          <button class="act act-cmt" data-id="${post.id}">üí¨ <span>${post.comments.length}</span></button>
          <button class="act act-share" data-id="${post.id}">üîÅ ReSpark</button>
          <button class="act act-save" data-id="${post.id}">‚≠ê Guardar</button>
          ${post.chain ? `<button class="act act-join" data-id="${post.id}">‚ûï Entrar na cadeia</button>` : ''}
        </div>
        <div class="comments" id="c_${post.id}"></div>
      </div>
    `;

    // actions
    $('.act-like', el).addEventListener('click', () => toggleLike(post, el));
    $('.act-cmt', el).addEventListener('click', () => toggleComments(post, el));
    $('.act-share', el).addEventListener('click', () => toast('Link copiado!'));
    $('.act-save', el).addEventListener('click', (e)=>{ e.currentTarget.dataset.active = e.currentTarget.dataset.active !== 'true'; toast('Guardado nos favoritos'); });
    if(post.chain) $('.act-join', el).addEventListener('click', () => joinChain(post, el));

    return el;
  }

  function chainBadge(chain){
    const left = Math.max(0, chain.deadline - Date.now());
    const hrs = Math.floor(left/3.6e6).toString().padStart(2,'0');
    const min = Math.floor((left%3.6e6)/6e4).toString().padStart(2,'0');
    const count = chain.nodes.length;
    return `<div class="row" style="margin-top:8px; font-size:12px; color:var(--muted)">‚è≥ Sparkchain ativa ‚Äî ${hrs}h${min}m restantes ¬∑ <b>${count}</b> participantes</div>`
  }

  function toggleLike(post, root){
    post.liked = !post.liked; post.likes += post.liked ? 1 : -1;
    const btn = $('.act-like', root);
    btn.dataset.active = post.liked;
    $('span', btn).textContent = post.likes;
  }

  function toggleComments(post, root){
    const box = $(`#c_${post.id}`, root);
    if(box.style.display === 'block'){ box.style.display='none'; return; }
    box.style.display='block';
    if(!box.dataset.loaded){
      box.innerHTML = commentComposer(post) + post.comments.map(renderComment).join('');
      const input = $('textarea', box);
      const publish = $('button', box);
      publish.addEventListener('click', ()=>{
        const t = input.value.trim();
        if(!t) return;
        const c = { id: `c_${Date.now()}`, author: state.currentUser, text:t };
        post.comments.push(c);
        box.insertAdjacentHTML('beforeend', renderComment(c));
        $('span', $('.act-cmt', root)).textContent = post.comments.length;
        input.value='';
      });
      box.dataset.loaded = '1';
    }
  }

  function commentComposer(){
    return `
      <div class="comment">
        <div class="avatar sm">VC</div>
        <div>
          <label class="hidden" for="cmt">Escrever coment√°rio</label>
          <textarea id="cmt" placeholder="Escreva um coment√°rio‚Ä¶" style="width:100%; min-height:48px; padding:8px; border-radius:10px; border:1px solid rgba(255,255,255,.08); background: var(--soft); color: var(--text);"></textarea>
          <div class="row" style="margin-top:6px; justify-content:flex-end;">
            <button class="btn">Publicar</button>
          </div>
        </div>
      </div>`;
  }

  function renderComment(c){
    return `
      <div class="comment">
        <div class="avatar sm">${escapeHtml((c.author.initials)||'US')}</div>
        <div>
          <div class="meta"><span class="name">${escapeHtml(c.author.name)}</span> ¬∑ agora</div>
          <div class="content">${linkify(escapeHtml(c.text))}</div>
        </div>
      </div>`;
  }

  function joinChain(post, root){
    const idea = window.prompt('Adicione o seu passo (m√°x 140 chars)');
    if(!idea) return;
    post.chain.nodes.push({ by: state.currentUser.name, text: idea.slice(0,140) });
    const content = $('.content', root);
    content.innerHTML += `\n\n‚Ä¢ ${escapeHtml(state.currentUser.name)}: ${escapeHtml(idea.slice(0,140))}`;
    // Refresh badge
    const row = $('.row', root);
    row.outerHTML = chainBadge(post.chain);
  }

  function timeAgo(date){
    const sec = Math.floor((Date.now()-date.getTime())/1000);
    if(sec < 60) return 'agora';
    const m = Math.floor(sec/60); if(m<60) return `${m} min`;
    const h = Math.floor(m/60); if(h<24) return `${h} h`;
    const d = Math.floor(h/24); return `${d} d`;
  }

  function escapeHtml(str=''){
    return str.replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[s]));
  }
  function linkify(str=''){
    return str.replace(/(https?:\/\/\S+)/g, '<a href="$1" target="_blank" rel="noopener">$1<\/a>')
              .replace(/#(\w+)/g, '<a href="#tag-$1">#$1<\/a>');
  }

  // Seed de posts demo
  const demo = [
    { name:'Ana Costa', tag:'@anac', initials:'AC', text:'Primeiro dia de aulas! #backtoschool', mood:'üòÑ feliz', audience:'Amigos', img:null },
    { name:'Jo√£o P', tag:'@joaop', initials:'JP', text:'Desafio de desenho: cria teu alien favorito!', mood:'ü§ù colaborativo', audience:'P√∫blico', img:null, chain:true },
    { name:'Maria R', tag:'@mariar', initials:'MR', text:'Playlist para foco: 30 min lo-fi üéß', mood:'üéß focado', audience:'C√≠rculos', img:null },
  ];

  demo.forEach(d => {
    const p = createPost({
      author: { id:'d', name:d.name, tag:d.tag, initials:d.initials },
      text: d.text,
      mood: d.mood,
      audience: d.audience,
      img: d.img,
      chain: d.chain ? { deadline: Date.now()+6*60*60*1000, nodes: [] } : null
    });
    const el = renderPost(p); feed.append(el);
  });

</script>
</body>
</html>
